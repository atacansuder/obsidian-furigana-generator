### [English](./README.md) • 日本語

> このドキュメントは、オリジナルの英語版を機械翻訳したものです。

# Obsidian Furigana Generator

Obsidian Furigana Generator は、[Obsidian](https://obsidian.md)で日本語のテキストにルビ（ふりがな）を振るためのプラグインです。このプラグインには、ルビ生成に必要なロジックと辞書ファイルが含まれています。

## 主な機能

-   **自動ルビ振り機能**: コマンド一つで、選択した日本語テキストまたはノート全体にルビを自動で追加します。
-   **フィルター機能**:
    -   **JLPT レベル**: すでに習得済みの JLPT レベル（N1 ～ N5）の漢字をルビ振りの対象から除外できます。
    -   **カスタム除外リスト**: ルビ振りの際に無視したい単語の個人リストを作成できます。
-   **詳細な制御**: 単語が出現するたびにルビを振るか、文・段落・テキスト全体で最初に出現したときにのみルビを振るか、範囲を設定できます。
-   **簡単なワークフロー**: コマンドパレットまたは右クリックのコンテキストメニューからコマンドにアクセスできます。
-   **安全な処理**: 見出し、リンク、コードブロック、そして既存のルビ（ふりがな）はスキップされ、ノートのフォーマットが崩れるのを防ぎます。

## インストール方法

1.  [obsidian.md](https://obsidian.md/)から**Obsidian**をダウンロードしてインストールします。
2.  「設定」→「コミュニティプラグイン」→「コミュニティプラグインをオンにする」でコミュニティプラグインを有効にします。
3.  **Furigana Generator**をインストールします。「閲覧」をクリック → 「Furigana Generator」を検索 → 「インストール」 → 「有効化」します。

## 使い方

コマンドパレットまたは右クリックのコンテキストメニューを使用して、ルビの追加や削除ができます。ルビ生成の挙動は[プラグイン設定](#設定)でカスタマイズできます（例：単語が出現するたびにルビを振るか、段落内で最初の出現時のみにするかなど）。

### コマンドパレット

1.  コマンドパレットを開きます（デフォルトのホットキーは`Ctrl+P`、macOS では`Cmd+P`です）。
2.  「Furigana」と入力すると、利用可能なコマンドが表示されます。

以下のコマンドが利用可能です:

-   **選択範囲にルビを振る**: ハイライトした日本語テキストにルビを生成して追加します。
-   **選択範囲のルビを削除**: ハイライトしたテキストからすべてのルビを削除します。
-   **ノート全体にルビを振る**: 現在のノート全体をスキャンし、すべての日本語テキストにルビを追加します。
-   **ノート全体のルビを削除**: 現在のノート全体からすべてのルビを削除します。
-   **除外漢字として登録...**: 選択範囲から漢字を含む単語を抽出し、カスタム除外リストに追加します。このリストにある単語はルビ生成時に無視されます。固有名詞や既に知っている単語に便利です。除外リストに追加する前に、検出された漢字を確認・編集する機会があります。

### コンテキストメニュー（右クリック）

エディタ内で右クリックすることでも、コマンドにアクセスできます。表示されるオプションは、テキストを選択しているかどうかによって変わります。

-   **テキストを選択している場合**: 選択範囲のルビを追加・削除するオプションや、選択範囲を除外リストに追加するオプションが表示されます。
-   **テキストを選択していない場合**: ノート全体のルビを追加・削除するオプションが表示されます。

> **注**: プラグイン設定の「コンテキストメニューにボタンを追加」で、コンテキストメニューのコマンドの表示・非表示を切り替えられます。これはデフォルトで有効になっています。

## 設定

「設定」→「コミュニティプラグイン」→「Furigana Generator」でプラグインの挙動をカスタマイズできます。

### 一般

-   **言語**: プラグインのインターフェースと言語の表示言語を設定します。英語と日本語が利用可能です。

    > **注**: 言語を変更した後、コマンドパレットやコンテキストメニューに変更を完全に反映させるには、Obsidian のリロードが必要な場合があります。

-   **最初の漢字だけにふりがなをつける**: 特定のテキスト内で繰り返し出現する単語に、どのくらいの頻度でルビを振るかを制御します。

    -   **すべての漢字**: （デフォルト）単語が出現するたびに追加します。
    -   **文の最初の漢字**: 各文の中で単語が最初に出現したときだけルビを追加します。
    -   **段落の最初の漢字**: 各段落の中で単語が最初に出現したときだけルビを追加します。
    -   **最初の出現のみ**: 選択範囲またはノート全体で単語が一番最初に出現したときだけルビを追加します。

-   **見出しを除外**: 有効にすると、見出し内のテキストにはルビが生成されません。見出しにルビを振ると[見出しへのリンク](https://publish.obsidian.md/help-ja/%E3%82%AC%E3%82%A4%E3%83%89/%E5%86%85%E9%83%A8%E3%83%AA%E3%83%B3%E3%82%AF#%E8%A6%8B%E5%87%BA%E3%81-9%E3%81%B8%E3%81%AE%E3%83%AA%E3%83%B3%E3%82%AF)が壊れる可能性があるので、見出しにルビを振る際は注意してください。

-   **コンテキストメニューにボタンを追加**: 有効にすると、プラグインのコマンドがコマンドパレットに加えて右クリックのコンテキストメニューにも表示されます。

### 表示設定

-   **ホバーするまでふりがなを非表示**: 有効にすると、ルビはデフォルトで非表示になり、単語の上にマウスカーソルを合わせたときだけ表示されます。

    > **注**: [Japanese Novel Ruby](https://github.com/k-quels/japanese-novel-ruby) プラグインにも同様の設定があり、競合する可能性があります。切り替える前によく確認し、どちらか一方の設定のみを使用してください。

-   **ふりがなフォントサイズ (Furigana font size)**: 本文のフォントサイズを基準に、ルビのテキストサイズを調整します。スライダーを使って 50%（デフォルト）から 150%の間で値を設定できます。

-   **構文 (Syntax)**: ルビを生成するために使用されるマークアップを決定します。

    -   **Ruby**: （デフォルト）HTML の`<ruby>`タグを使用します。これは Obsidian の閲覧ビューでそのまま正しくレンダリングされます。
    -   **Markdown**: `{漢字|よみ}`という構文を使用します。
    -   **Japanese Novel**: `漢字《よみ》`という構文を使用します。
        > **警告**: `Markdown` または `Japanese Novel` 構文を閲覧ビューで正しくレンダリングするには、[Markdown Furigana](https://github.com/steven-kraft/obsidian-markdown-furigana) や [Japanese Novel Ruby](https://github.com/k-quels/japanese-novel-ruby) のような対応するプラグインをインストールする必要があります。この設定は、これらのプラグインのユーザーをサポートするために用意されています。

### フィルター

-   **JLPT フィルター**: JLPT レベルに基づいて、漢字へのルビ振りを防ぐことができます。例えば、N5 の漢字に慣れている場合、「JLPT N5 の漢字を含める」のチェックを外すことで、それらの漢字にルビが振られなくなります。

-   **カスタム除外リスト**: ここで、ルビを**一切**振りたくない単語のリストを指定できます。
    -   1 行に 1 単語ずつ追加してください。
    -   動詞は必ず基本形（辞書形）で入力してください（例：`食べます`や`食べた`ではなく`食べる`）。
    -   エディタから直接`除外漢字として登録...`コマンドを使って、このリストに単語を追加することもできます。

## フィードバック

提案やバグ報告がありましたら、GitHub の Issue を作成してください。

## 開発者へのサポート

このプラグインが役に立ったと思われましたら、コーヒーをご馳走してくださると嬉しいです。

<a href="https://www.buymeacoffee.com/asuder">
    <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me a Coffee" width="180" height="50">
</a>
